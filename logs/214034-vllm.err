2025-05-07 01:33:29.797964: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746596009.811391  214275 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746596009.815528  214275 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-07 01:33:29.830746: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-07 01:33:49.846256: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1746596029.860083  214646 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1746596029.864219  214646 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-07 01:33:49.878983: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.67it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  5.66it/s]

INFO:     Started server process [214275]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Shutting down
Task exception was never retrieved
future: <Task finished name='Task-39' coro=<create_chat_completion() done, defined at /data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/utils.py:75> exception=ZMQError('Socket operation on non-socket')>
Traceback (most recent call last):
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/async_llm.py", line 284, in generate
    out = q.get_nowait() or await q.get()
                            ^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/output_processor.py", line 47, in get
    await self.ready.wait()
  File "/home/ctrenton/.local/share/uv/python/cpython-3.12.8-linux-x86_64-gnu/lib/python3.12/asyncio/locks.py", line 212, in wait
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/utils.py", line 85, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/openai/api_server.py", line 476, in create_chat_completion
    generator = await handler.create_chat_completion(request, raw_request)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/openai/serving_chat.py", line 267, in create_chat_completion
    return await self.chat_completion_full_generator(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/openai/serving_chat.py", line 906, in chat_completion_full_generator
    async for res in result_generator:
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/async_llm.py", line 295, in generate
    await self.abort(request_id)
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/async_llm.py", line 352, in abort
    await self.engine_core.abort_requests_async(request_ids)
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/core_client.py", line 702, in abort_requests_async
    await self._send_input(EngineCoreRequestType.ABORT, request_ids)
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/zmq/_future.py", line 515, in _add_send_event
    r = send(msg, **nowait_kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/zmq/sugar/socket.py", line 761, in send_multipart
    self.send(msg, zmq.SNDMORE | flags, copy=copy, track=track)
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/zmq/sugar/socket.py", line 710, in send
    return super().send(data, flags=flags, copy=copy, track=track)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "_zmq.py", line 1092, in zmq.backend.cython._zmq.Socket.send
  File "_zmq.py", line 1151, in zmq.backend.cython._zmq.Socket.send
  File "_zmq.py", line 1344, in zmq.backend.cython._zmq._send_copy
  File "_zmq.py", line 1339, in zmq.backend.cython._zmq._send_copy
  File "_zmq.py", line 179, in zmq.backend.cython._zmq._check_rc
zmq.error.ZMQError: Socket operation on non-socket
Task exception was never retrieved
future: <Task finished name='Task-42' coro=<create_chat_completion() done, defined at /data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/utils.py:75> exception=ZMQError('Socket operation on non-socket')>
Traceback (most recent call last):
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/async_llm.py", line 284, in generate
    out = q.get_nowait() or await q.get()
                            ^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/output_processor.py", line 47, in get
    await self.ready.wait()
  File "/home/ctrenton/.local/share/uv/python/cpython-3.12.8-linux-x86_64-gnu/lib/python3.12/asyncio/locks.py", line 212, in wait
    await fut
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/utils.py", line 85, in wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/openai/api_server.py", line 476, in create_chat_completion
    generator = await handler.create_chat_completion(request, raw_request)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/openai/serving_chat.py", line 267, in create_chat_completion
    return await self.chat_completion_full_generator(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/entrypoints/openai/serving_chat.py", line 906, in chat_completion_full_generator
    async for res in result_generator:
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/async_llm.py", line 295, in generate
    await self.abort(request_id)
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/async_llm.py", line 352, in abort
    await self.engine_core.abort_requests_async(request_ids)
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/vllm/v1/engine/core_client.py", line 702, in abort_requests_async
    await self._send_input(EngineCoreRequestType.ABORT, request_ids)
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/zmq/_future.py", line 515, in _add_send_event
    r = send(msg, **nowait_kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/zmq/sugar/socket.py", line 761, in send_multipart
    self.send(msg, zmq.SNDMORE | flags, copy=copy, track=track)
  File "/data2/ctrenton/uv/llm_server/lib/python3.12/site-packages/zmq/sugar/socket.py", line 710, in send
    return super().send(data, flags=flags, copy=copy, track=track)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "_zmq.py", line 1092, in zmq.backend.cython._zmq.Socket.send
  File "_zmq.py", line 1151, in zmq.backend.cython._zmq.Socket.send
  File "_zmq.py", line 1344, in zmq.backend.cython._zmq._send_copy
  File "_zmq.py", line 1339, in zmq.backend.cython._zmq._send_copy
  File "_zmq.py", line 179, in zmq.backend.cython._zmq._check_rc
zmq.error.ZMQError: Socket operation on non-socket
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
